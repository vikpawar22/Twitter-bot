USE NBA;

DROP TABLE TWITTER_USER;
DROP TABLE Tweets_Details;
DROP TABLE Tweet_Tags;
DROP TABLE PLAYER;
DROP TABLE PLAYER_STATS;
DROP TABLE PLAYER_BRIDGE;
DROP TABLE TEAM_BRIDGE;
DROP TABLE TEAM;
DROP TABLE STADIUM;
DROP TABLE COACH;


CREATE TABLE TWITTER_USER(
Twitter_handle VARCHAR(500) primary Key,
Name VARCHAR(100),
profile_pic_url VARCHAR(100),
user_description VARCHAR(1000),
Followers_count Integer,
Following_count Integer
);

CREATE TABLE Tweets_Details(
tweet_id VARCHAR(500) primary Key,
Twitter_handle VARCHAR(500),
tweet_source VARCHAR(500),
Created_at Datetime,
tweet_text VARCHAR(1000)
);

CREATE TABLE Tweet_Tags(
tweet_id VARCHAR(500),
tags Varchar(100)
);

ALTER TABLE Tweets_Details
ADD CONSTRAINT Tweets_Details_fk  FOREIGN KEY (Twitter_handle)
REFERENCES TWITTER_USER(Twitter_handle);

ALTER TABLE Tweet_Tags
ADD CONSTRAINT Tweets_Tags_fk  FOREIGN KEY (tweet_id)
REFERENCES Tweets_Details(tweet_id);


SELECT * FROM TWITTER_USER;
SELECT * FROM Tweets_Details;
SELECT * FROM Tweet_Tags;
SELECT COUNT(*) FROM Tweets_Details;



CREATE TABLE PLAYER(
PLAYER_ID VARCHAR(50) Primary Key,
Player_Name VARCHAR(50),
Position VARCHAR(50),
Age Integer,
TEAM_ID VARCHAR(50)
);
SELECT * FROM PLAYER;

CREATE TABLE PLAYER_STATS(
PLAYER_ID VARCHAR(50),
Game Decimal,
Game_Started Decimal,
Minutes_Played Decimal,
Field_Goals Decimal,
Field_Goal_Attempts Decimal ,
Field_Goal_Percentage Decimal,
3_Points Decimal,
3_Points_Attempts Decimal,
3_Points_Percentage Decimal,
2_Points Decimal,
2_Points_Attemps Decimal,
2_Points_Percentage Decimal,
Effective_Field_Goal_Percentage Decimal,
Free_Throws Decimal,
Free_Throws_Attempts Decimal,
Free_Throws_Percentage Decimal,
Offensive_Rebounds Decimal,
Defensive_Rebounds Decimal,
Total_Rebounds Decimal,
Assists Decimal,
Steals Decimal,
Blocks Decimal,
Turnover Decimal,
Personal_Fouls Decimal,
Points Decimal
);
SELECT * FROM PLAYER_STATS;
CREATE TABLE PLAYER_BRIDGE (
TWEET_ID VARCHAR(50),
PLAYER_ID VARCHAR(50)
);

CREATE TABLE TEAM_BRIDGE (
TWEET_ID VARCHAR(50),
TEAM_ID VARCHAR(50)
);

CREATE TABLE TEAM(
TEAM_ID VARCHAR(50) Primary Key,
Team_Name VARCHAR(50),
Win Integer,
Loss Integer,
Win_Loss_Percent Integer,
Points_Per_Game Decimal,
Opponents_Points_Per_Game Decimal,
SRS Decimal
);

CREATE TABLE STADIUM(
STADIUM_ID VARCHAR(50),
Stadium_Name VARCHAR(50),
TEAM_ID VARCHAR(50),
SIze Integer,
Location VARCHAR(50)
);

CREATE TABLE COACH(
COACH_ID VARCHAR(50),
TEAM_ID VARCHAR(50),
Coach_Name VARCHAR(50),
Games Integer,
Win Integer,
Loss Integer,
Win_Percentage Decimal
);

ALTER TABLE PLAYER_STATS
ADD CONSTRAINT PLAYER_STATS_fk  FOREIGN KEY (PLAYER_ID)
REFERENCES PLAYER(PLAYER_ID);

ALTER TABLE PLAYER_BRIDGE
ADD CONSTRAINT PLAYER_BRIDGE_fk  FOREIGN KEY (PLAYER_ID)
REFERENCES PLAYER(PLAYER_ID);

ALTER TABLE PLAYER
ADD CONSTRAINT PLAYER_fk  FOREIGN KEY (TEAM_ID)
REFERENCES TEAM(TEAM_ID);

ALTER TABLE TEAM_BRIDGE
ADD CONSTRAINT TEAM_BRIDGE_fk  FOREIGN KEY (TEAM_ID)
REFERENCES TEAM(TEAM_ID);

ALTER TABLE COACH
ADD CONSTRAINT COACH_fk  FOREIGN KEY (TEAM_ID)
REFERENCES TEAM(TEAM_ID);

ALTER TABLE STADIUM
ADD CONSTRAINT STADIUM_fk  FOREIGN KEY (TEAM_ID)
REFERENCES TEAM(TEAM_ID);

ALTER TABLE PLAYER_BRIDGE
ADD CONSTRAINT PLAYER_BRIDGE_fk_1 FOREIGN KEY (TWEET_ID)
REFERENCES Tweets_Details(TWEET_ID);

ALTER TABLE TEAM_BRIDGE
ADD CONSTRAINT TEAM_BRIDGE_fk_1 FOREIGN KEY (TWEET_ID)
REFERENCES Tweets_Details(TWEET_ID);

INSERT INTO PLAYER VALUES(201,'LeBron James','Power Forward',37,201);
INSERT INTO PLAYER VALUES(102,'Jerami Grant','Power forward',28,202);
INSERT INTO PLAYER VALUES(103,'Kyrie Irving','Shoothing Guard',30,203);
INSERT INTO PLAYER VALUES(104,'Stephen Curry','Point guard',34,204);
INSERT INTO PLAYER VALUES(105,'James Capers','Shoothing Guard',35,205);
INSERT INTO PLAYER VALUES(106,'Kazuma Kyle','Power Forward',27,206);
INSERT INTO PLAYER VALUES(107,'Jimmy Buckets','Small Forward',33,207);
INSERT INTO PLAYER VALUES(108,'Kelly Oubre Jr','Small Forward',26,208);
INSERT INTO PLAYER VALUES(109,'Jimmy Butler','Power Forward',33,209);
INSERT INTO PLAYER VALUES(110,'Trae young','Point guard',24,210);

INSERT INTO PLAYER_STATS VALUES(101,56,56,37.2,11.4,21.8,0.524,2.9,8,0.359,8.6,13.8,0.62,0.59,4.5,6,0.756,1.1,7.1,8.2,6.2,1.3,1.1,3.5,2.2,30.3);
INSERT INTO PLAYER_STATS VALUES(102,47,47,31.9,6.3,14.9,0.426,1.9,5.4,0.358,4.4,9.5,0.465,0.491,4.6,5.5,0.838,0.6,3.5,4.1,2.4,0.9,1,1.8,2.3,19.2);
INSERT INTO PLAYER_STATS VALUES(103,29,29,37.6,10,21.2,0.469,3.4,8.2,0.418,6.5,13,0.501,0.55,4.1,4.4,0.915,0.6,3.8,4.4,5.8,1.4,0.6,2.5,2.8,27.4);
INSERT INTO PLAYER_STATS VALUES(104,64,64,34.5,8.4,19.1,0.437,4.5,11.7,0.381,3.9,7.4,0.527,0.554,4.3,4.7,0.923,0.5,4.7,5.2,6.3,1.3,0.4,3.2,2,25.5);
INSERT INTO PLAYER_STATS VALUES(105,25,25,25,6.7,21.2,0.459,2.9,7.5,0.418,4.4,9.8,0.456,0.55,4.2,4.4,0.915,0.5,3.2,4.4,3.4,1.6,1,3.1,2.4,25.2);
INSERT INTO PLAYER_STATS VALUES(106,28,28,36.6,9,20.2,0.457,3.2,8.1,0.456,6.2,12,0.5,0.65,4.1,4.4,0.915,0.6,3.8,4.4,5.8,1.4,0.6,2.5,2.8,27.4);
INSERT INTO PLAYER_STATS VALUES(107,12,12,36,8.5,23.6,375,2.3,7.6,0.305,6.2,15.3,0.405,0.421,7.3,8.2,0.825,0.7,2.1,3.1,9.1,0.7,0.1,3.4,1.4,26.5);
INSERT INTO PLAYER_STATS VALUES(108,13,13,30.4,6.7,16.2,0.414,2.8,8,0.346,3.9,8.2,0.481,0.5,2.2,3.2,0.69,0.9,3.6,4.5,1.3,1.3,0.3,1.2,3.2,18.4);
INSERT INTO PLAYER_STATS VALUES(109,10,10,36,7,14.8,0.473,0.9,2.5,0.361,6.1,12.3,0.496,0.503,7.4,8.4,0.881,2,4.5,6.5,5.9,2,0.2,1.7,1.4,22.3);
INSERT INTO PLAYER_STATS VALUES(110,11,11,34.9,8.6,23.1,0.374,2.4,7.7,0.306,6.3,15.4,0.408,0.425,7.8,8.5,0.925,0.9,2.5,3.4,9.2,0.8,0.2,3.5,1.5,27.5);


INSERT INTO COACH VALUES(301,201,'Darvin Ham',11,2,9,0.182);
INSERT INTO COACH VALUES(302,202,'Chauncey Billups',94,36,58,0.383);
INSERT INTO COACH VALUES(303,203,'Jacque Vaughn',231,68,163,0.294);
INSERT INTO COACH VALUES(304,204,'Steve Kerr',640,433,207,0.677);
INSERT INTO COACH VALUES(305,205,'Erik Spoelstra',1125,665,460,0.591);
INSERT INTO COACH VALUES(306,206,'Wes Unseld Jr.',94,41,53,0.436);
INSERT INTO COACH VALUES(308,208,'Steve Clifford',650,295,355,0.454);
INSERT INTO COACH VALUES(310,210,'Nate McMillan',1381,739,642,0.535);
INSERT INTO COACH VALUES(311,211,'Stephen Silas',166,39,127,0.235);
INSERT INTO COACH VALUES(312,212,'Billy Donovan',567,326,241,0.575);

INSERT INTO TEAM VALUES(201,'Los Angeles Lakers',2,9,0.182,107.7,116.1,-7.77);
INSERT INTO TEAM VALUES(202,'Portland Trail Blazers',9,3,0.75,109.1,106.6,3.35);
INSERT INTO TEAM VALUES(203,'Brooklyn Nets',5,7,0.417,110.7,109.3,2.92);
INSERT INTO TEAM VALUES(204,'Golden State Warriors',4,7,0.364,117.3,120.6,-5.16);
INSERT INTO TEAM VALUES(205,'Miami Heat ',5,7,0.417,108.8,109.4,-0.04);
INSERT INTO TEAM VALUES(206,' Washington Wizards',6,6,0.5,2,107.5,110.6);
INSERT INTO TEAM VALUES(208,'Charlotte Hornets',3,10,0.231,108.2,113.4,-5.66);
INSERT INTO TEAM VALUES(210,'Atlanta Hawks',8,4,0.667,115.7,113,2.12);
INSERT INTO TEAM VALUES(211,'Houston Rockets',2,10,0.167,110.3,117.8,-5.6);
INSERT INTO TEAM VALUES(212,'Chicago Bulls',6,7,0.462,111.4,109.8,3.56);

SELECT * FROM TEAM;

INSERT INTO PLAYER_BRIDGE VALUES(1590911143928741889,101);
INSERT INTO PLAYER_BRIDGE VALUES(1590909182747648000,102);
INSERT INTO PLAYER_BRIDGE VALUES(1590781218790211584,103);
INSERT INTO PLAYER_BRIDGE VALUES(1591116522818523136,104);
INSERT INTO PLAYER_BRIDGE VALUES(1591104560109686784,105);
INSERT INTO PLAYER_BRIDGE VALUES(1591064450756378625,106);
INSERT INTO PLAYER_BRIDGE VALUES(1591068240532455430,107);
INSERT INTO PLAYER_BRIDGE VALUES(1590914869016104960,108);
INSERT INTO PLAYER_BRIDGE VALUES(1590910704953053185,109);
INSERT INTO PLAYER_BRIDGE VALUES(1590906335876390913,110);

INSERT INTO TEAM_BRIDGE VALUES(1590911143928741889,201);
INSERT INTO TEAM_BRIDGE VALUES(1590909182747648000,202);
INSERT INTO TEAM_BRIDGE VALUES(1590781218790211584,203);
INSERT INTO TEAM_BRIDGE VALUES(1591116522818523136,204);
INSERT INTO TEAM_BRIDGE VALUES(1591104560109686784,205);
INSERT INTO TEAM_BRIDGE VALUES(1591064450756378625,206);
INSERT INTO TEAM_BRIDGE VALUES(1591068240532455430,207);
INSERT INTO TEAM_BRIDGE VALUES(1590914869016104960,208);
INSERT INTO TEAM_BRIDGE VALUES(1590910704953053185,209);
INSERT INTO TEAM_BRIDGE VALUES(1590906335876390913,210);

SELECT Name, max(Followers_count)
FROM TWITTER_USER
WHERE Following_count = ( SELECT max(Following_count ) FROM TWITTER_USER);

SELECT Tweet_Text
FROM TWEETS_DETAILS
WHERE Tweet_Text LIKE '%Curry%';

SELECT Twitter_Handle, Tags
FROM TWEETS_DETAILS AS td
INNER JOIN TWEET_TAGS AS tt ON td.TWEET_ID = tt.TWEET_ID
WHERE Tweet_Text LIKE '%CurryBrand%';

SELECT Twitter_Handle, User_Description, max(Following_count)
FROM  TWITTER_USER;

SELECT Twitter_Handle, max(Followers_count), min(Following_count)
FROM TWITTER_USER;

SELECT tu.Twitter_Handle, tu.User_Description
FROM TWITTER_USER AS tu
INNER JOIN TWEETS_DETAILS AS td On tu.Twitter_Handle = td.Twitter_Handle
WHERE td.Tweet_Text LIKE '%NBA%';

SELECT Count(*)
FROM TWITTER_USER
WHERE User_Description LIKE '%NBA%' OR User_Description LIKE '%basketball%';

SELECT tu.Name
FROM TWITTER_USER AS tu
INNER JOIN TWEETS_DETAILS AS td On tu.Twitter_Handle  = td.Twitter_Handle
WHERE td.Tweet_Text  LIKE '%Kyrie%' OR td.Tweet_Text LIKE '%apologized%';

SELECT tu.Twitter_Handle
FROM TWITTER_USER AS tu
INNER JOIN TWEETS_DETAILS AS td On tu.Twitter_Handle  = td.Twitter_Handle
WHERE td.Tweet_Text  LIKE '%LeBron James%' OR td.Tweet_Text LIKE '%Nike%';

SELECT tu.Name
FROM TWITTER_USER AS tu 
INNER JOIN TWEETS_DETAILS AS td On tu.Twitter_Handle  = td.Twitter_Handle
WHERE td.Tweet_Text LIKE '%Jimmy%' OR td.Tweet_Text  LIKE '%triple-double%';

/* 7 Questions */
SELECT tu.Twitter_Handle
FROM TWITTER_USER AS tu
INNER JOIN TWEETS_DETAILS AS td On tu.Twitter_Handle  = td.Twitter_Handle
WHERE td.Tweet_Text  LIKE '%LeBron James%' OR td.Tweet_Text LIKE '%Nike%';

SELECT tu.Twitter_Handle, td.created_at
FROM TWITTER_USER AS tu
INNER JOIN TWEETS_DETAILS AS td On tu.Twitter_Handle  = td.Twitter_Handle
WHERE td.Tweet_Text  LIKE '%LeBron James%' OR td.Tweet_Text LIKE '%Nike%';

select tu.Name, td.created_at, td.Tweet_Text 
FROM TWITTER_USER AS tu
INNER JOIN TWEETS_DETAILS AS td On tu.Twitter_Handle  = td.Twitter_Handle
WHERE td.Tweet_Text  LIKE '%LeBron James%' OR td.Tweet_Text LIKE '%Nike%' and 
created_at > DATE_SUB(CURDATE(), INTERVAL 1 DAY);

select tu.Name, td.created_at, count(td.Tweet_Text) 
FROM TWITTER_USER AS tu
INNER JOIN TWEETS_DETAILS AS td On tu.Twitter_Handle  = td.Twitter_Handle
WHERE td.Tweet_Text  LIKE '%LeBron James%' OR td.Tweet_Text LIKE '%Nike%' and 
created_at > DATE_SUB(CURDATE(), INTERVAL 1 DAY);

SELECT tg.Tags, MAX(tu.Followers_count)
FROM TWEETS_DETAILS AS td 
INNER JOIN Tweet_Tags AS tg ON td.TWEET_ID = tg.TWEET_ID
INNER JOIN Twitter_User tu ON tu.Twitter_Handle = td.Twitter_Handle;

SELECT tg.Tags, MAX(tu.Followers_count)
FROM TWEETS_DETAILS AS td 
INNER JOIN Tweet_Tags AS tg ON td.TWEET_ID = tg.TWEET_ID
INNER JOIN Twitter_User tu ON tu.Twitter_Handle = td.Twitter_Handle;

SELECT Tweet_Text, MAX(tu.Followers_count)
FROM TWEETS_DETAILS AS td 
INNER JOIN Twitter_User tu ON tu.Twitter_Handle = td.Twitter_Handle;
